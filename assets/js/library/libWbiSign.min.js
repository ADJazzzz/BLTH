// ==UserScript==
// @name          libWbiSign
// @namespace     https://github.com/SocialSisterYi/bilibili-API-collect/blob/master/docs/misc/sign/wbi.md
// @version       0.1
// @description   Wbi签名算法实现
// ==/UserScript==
class Wbi{static mixinKeyEncTab=[46,47,18,2,53,8,23,32,15,50,10,31,58,3,45,35,27,43,5,49,33,9,42,19,29,28,14,39,12,38,41,13,37,48,7,16,24,55,40,61,26,17,0,1,60,51,30,4,22,25,54,21,56,59,6,63,57,62,11,36,20,34,44,52];static getMixinKey(e){let t="";return mixinKeyEncTab.forEach((n=>{t+=e[n]})),t.slice(0,32)}static encWbi(e,t,n){const i=getMixinKey(t+n),c=Math.round(Date.now()/1e3),o=/[!'\(\)*]/g;let s=[];e=Object.assign(e,{wts:c}),Object.keys(e).sort().forEach((t=>{s.push(encodeURIComponent(t)+"="+encodeURIComponent((""+e[t]).replace(o,"")))})),s=s.join("&");const a=CryptoJS.MD5(s+i).toString();return s+"&w_rid="+a}}